# FRUITS
(**F**eature Ext**R**action **U**sing **IT**erated **S**ums)

## Installation
This package can be installed on your local machine by executing the file [setup.py](setup.py).
```
  $ python setup.py install
```

## Documentation
The documentation of __FRUITS__ can be created by calling `make html` in the [docs](docs) folder. This will need a few dependencies to work. Please install the following packages using `pip` before executing the `make` command.
- sphinx
- sphinx_rtd_theme
- m2r2

This should create a local directory `docs/build`. Open the file `docs/build/index.html` in a browser to access the documentation.

## Pipeline
The __FRUITS__ package works as a pipeline that extracts features from multidimensional time series data.<br>
To initialize the data one has to create a `fruits.Fruit` object. This object can now be customized by the user in three different ways. There are standard configurations and objects for each of the following steps in `fruits` available to choose from.
- Data Preparation: `DataPreparateur` objects are used to preprocess the data. This is an optional step.
- Calculation of Iterated Sums: `SummationIterator` objects specify which Iterated Sums should be calculated<br>
  For example:<br>`<[11], ISS(X)>=numpy.cumsum([x^2 for x in X])` is the result of `fruits.core.ISS(X, [fruits.iterators.SimpleWord("[11]")])`
- Feature Sieving: `FeatureSieve` objects have to be specified in order to extract the actual results of this pipeline from the results of the previous step(s).<br>
  The total number of features per time series is `[number of FeatureSieve objects] * [number of SummationIterator objects]`.
  
## Example
A simple example could look like this:
```python
# think of a 3 dimensional time series dataset
X_train, y_train, X_test, y_test = ...

# create a Fruit object
myfruit = fruits.Fruit("myfruit - Fruit class example")

# add a DataPreparateur to it by using predefined ones from fruits.preparateurs
myfruit.add(fruits.preparateurs.INC(zero_padding=True))

# generate simple SummationIterator objects (i.e. SimpleWords)
simple_words = fruits.iterators.generate_words(
                                dim=3,
                                monomial_length=2,
                                n_monomials=1)
# simple_words is now a list of words in the extended alphabet generated by {1,2,3}:
# [1], [2], [3], [11], [22], [33], [12], [13], [23]

# add the iterators to the class instance
myfruit.add(simple_words)

# choose from a variety of FeatureFilter objects in fruits.features
myfruit.add(fruits.features.PPV(quantile=0.5, constant=False))
myfruit.add(fruits.features.MAX)

# fit the object to the data
myfruit.fit(X_train)
# get features for the training data
X_train_features = myfruit.transform(X_train)
# get features for the testing data
X_test_features = myfruit.transform(X_test)
```

## UCR-Experiments
We test the pipeline for accuracy by doing classification experiments of some UCR-datasets for different `fruits.Fruit` objects. You can [download](https://www.timeseriesclassification.com/Downloads/Archives/Univariate2018_arff.zip) the datasets from [timeseriesclassification.com](https://timeseriesclassification.com).

For detailed instructions on how to perform some of these experiments, have a look at the file [configurations_on_ucr.py](experiments/configurations_on_ucr.py). This python script can be executed in a terminal/command line.

## Unit tests
There are a bunch of [tests](tests) for __FRUITS__ available to execute. To do this, enter the command
```
  $ python -m pytest tests
```
in a terminal/command line from the main directory of this repository.
